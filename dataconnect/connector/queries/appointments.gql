# ============================
# APPOINTMENT QUERIES
# ============================

# List all appointments with pagination
query ListAppointments($limit: Int = 8, $offset: Int = 0) @auth(level: USER) {
  appointments(limit: $limit, offset: $offset, orderBy: [{ appointmentDate: DESC }]) {
    id
    appointmentDate
    appointmentTime
    type
    observations
    user {
      id
      name
    }
    beneficiary {
      id
      fullName
      studentNumer
    }
    status {
      id
      code
      description
    }
    createdAt
    updatedAt
  }
}

# Get appointment by id
query GetAppointmentById($id: UUID!) @auth(level: USER) {
  appointment(id: $id) {
    id
    appointmentDate
    appointmentTime
    type
    observations
    user {
      id
      name
      email
    }
    beneficiary {
      id
      fullName
      studentNumer
      contactNumber
    }
    status {
      id
      code
      description
      color
    }
    createdAt
    updatedAt
  }
}

# List appointments by beneficiary
query ListAppointmentsByBeneficiary($beneficiaryId: UUID!, $limit: Int = 8, $offset: Int = 0) @auth(level: USER) {
  appointments(
    where: { beneficiary: { id: { eq: $beneficiaryId } } }
    limit: $limit
    offset: $offset
    orderBy: [{ appointmentDate: DESC }]
  ) {
    id
    appointmentDate
    appointmentTime
    type
    observations
    status {
      id
      code
      description
    }
    createdAt
    updatedAt
  }
}

# List appointments by date range
query ListAppointmentsByDateRange($startDate: Date!, $endDate: Date!, $limit: Int = 8, $offset: Int = 0) @auth(level: USER) {
  appointments(
    where: {
      _and: [
        { appointmentDate: { ge: $startDate } },
        { appointmentDate: { le: $endDate } }
      ]
    }
    limit: $limit
    offset: $offset
    orderBy: [{ appointmentDate: ASC }]
  ) {
    id
    appointmentDate
    appointmentTime
    type
    observations
    beneficiary {
      id
      fullName
    }
    status {
      id
      code
      description
    }
    createdAt
    updatedAt
  }
}

